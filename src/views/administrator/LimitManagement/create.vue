<template>
  <div class="wrap__content">
    <div class="container">
      <div class="row">
        <div class="col-xl-2 col-lg-3">
          <v-sidebar :active="['LimitManagement']"></v-sidebar>
        </div>
        <div class="col-xl-10 col-lg-9">
          <div class="content-wrapper">
            <div class="card__content">
              <div class="card__content-header">
                <div class="content__title">
                  <div class="content__page--back">
                    <a @click="$router.go(-1)">
                      <svg
                        width="21"
                        height="21"
                        viewBox="0 0 21 21"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                      >
                        <path
                          d="M13.125 5.25L7.875 10.5L13.125 15.75"
                          stroke="#52A5FC"
                          stroke-width="1.5"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </a>
                  </div>
                  <div class="content__title--element">
                    <div class="content__title--text">Создание нового лимита</div>
                    <div class="content__title--subtext">
                      Рыбохозяйственные водоемы международного и республиканского значения
                    </div>
                  </div>
                </div>
              </div>
              <div class="card__content--body">
                <form method="POST" @submit.prevent="onSubmit">
                  <!--<div class="form__line">
                    <div class="form__line--left">
                      <div class="form__line--title">
                        Наименование лимита
                      </div>
                    </div>
                    <div class="form__line--right">
                      <div class="col-xl-5">
                        <div class="form__line--input" :class="[errorMessage.messages && errorMessage.messages.name ? 'input--error' : '']">
                          <input type="text" class="input-linck" required="" name="name" value="" placeholder="Наименование">
                        </div>
                        <div class="input-required" v-if="errorMessage.messages && errorMessage.messages.name"><p v-for="massage in errorMessage.messages.name">{{ massage }}</p></div>
                      </div>
                    </div>
                  </div>-->

                  <div class="row">
                    <div class="col-xl-12">
                      <div class="form__line">
                        <div class="form__line--left"></div>
                        <div class="form__line--right">
                          <div class="form__limit--row">
                            <div class="col-lg-12">
                              <div class="row">
                                <div class="col-lg-6">
                                  <div class="form__checkbox--chapter">
                                    <div class="form__limit--btn">
                                      <!--  form__limit--success -->
                                      <div class="form__limit--icon">
                                        <svg
                                          width="43"
                                          height="43"
                                          viewBox="0 0 43 43"
                                          fill="none"
                                          xmlns="http://www.w3.org/2000/svg"
                                        >
                                          <path
                                            d="M4.87339 13.7062C5.22375 13.8091 5.56058 13.9535 5.87672 14.1362C6.98722 14.799 8.25638 15.149 9.54964 15.149C10.8429 15.149 12.1121 14.799 13.2226 14.1362C13.9221 13.7406 14.7122 13.5326 15.5159 13.5326C16.3196 13.5326 17.1096 13.7406 17.8092 14.1362C18.9331 14.7789 20.2054 15.117 21.5001 15.117C22.7947 15.117 24.067 14.7789 25.1909 14.1362C25.8905 13.7406 26.6805 13.5326 27.4842 13.5326C28.2879 13.5326 29.078 13.7406 29.7776 14.1362C30.913 14.7852 32.1965 15.1307 33.5042 15.1396C34.7677 15.137 36.0065 14.7901 37.0876 14.1362C37.4037 13.9535 37.7405 13.8091 38.0909 13.7062C38.5471 13.5732 38.9317 13.2644 39.1602 12.8477C39.3887 12.4311 39.4423 11.9408 39.3092 11.4846C39.1762 11.0284 38.8674 10.6438 38.4507 10.4153C38.0341 10.1868 37.5437 10.1332 37.0876 10.2662C36.4594 10.4601 35.8576 10.7309 35.2959 11.0725C34.7251 11.4063 34.0758 11.5822 33.4146 11.5822C32.7534 11.5822 32.1042 11.4063 31.5334 11.0725C30.2911 10.3757 28.8907 10.0097 27.4663 10.0097C26.0419 10.0097 24.6415 10.3757 23.3992 11.0725C22.8224 11.4076 22.1672 11.5842 21.5001 11.5842C20.8329 11.5842 20.1777 11.4076 19.6009 11.0725C18.3586 10.3757 16.9582 10.0097 15.5338 10.0097C14.1094 10.0097 12.709 10.3757 11.4667 11.0725C10.896 11.4063 10.2467 11.5822 9.58547 11.5822C8.92427 11.5822 8.27498 11.4063 7.70422 11.0725C7.14252 10.7309 6.54073 10.4601 5.91255 10.2662C5.45638 10.1332 4.96604 10.1868 4.54939 10.4153C4.13275 10.6438 3.82394 11.0284 3.69089 11.4846C3.55784 11.9408 3.61145 12.4311 3.83993 12.8477C4.06841 13.2644 4.45305 13.5732 4.90922 13.7062H4.87339ZM37.1234 28.1829C36.4952 28.3768 35.8934 28.6476 35.3317 28.9892C34.761 29.3229 34.1117 29.4989 33.4505 29.4989C32.7893 29.4989 32.14 29.3229 31.5692 28.9892C30.327 28.2923 28.9265 27.9264 27.5021 27.9264C26.0778 27.9264 24.6773 28.2923 23.4351 28.9892C22.8582 29.3243 22.203 29.5008 21.5359 29.5008C20.8688 29.5008 20.2135 29.3243 19.6367 28.9892C18.3945 28.2923 16.994 27.9264 15.5696 27.9264C14.1453 27.9264 12.7448 28.2923 11.5026 28.9892C10.9318 29.3229 10.2825 29.4989 9.6213 29.4989C8.96011 29.4989 8.31082 29.3229 7.74005 28.9892C7.17835 28.6476 6.57656 28.3768 5.94839 28.1829C5.72251 28.117 5.48587 28.0963 5.25198 28.1219C5.01809 28.1474 4.79153 28.2188 4.58523 28.332C4.37893 28.4451 4.19693 28.5977 4.04963 28.7812C3.90232 28.9647 3.7926 29.1754 3.72672 29.4012C3.66084 29.6271 3.64009 29.8638 3.66567 30.0976C3.69124 30.3315 3.76263 30.5581 3.87576 30.7644C3.9889 30.9707 4.14155 31.1527 4.32502 31.3C4.50849 31.4473 4.71918 31.557 4.94505 31.6229C5.29542 31.7258 5.63225 31.8701 5.94839 32.0529C7.05889 32.7157 8.32805 33.0657 9.6213 33.0657C10.9146 33.0657 12.1837 32.7157 13.2942 32.0529C13.9938 31.6572 14.7838 31.4493 15.5876 31.4493C16.3913 31.4493 17.1813 31.6572 17.8809 32.0529C19.0048 32.6956 20.277 33.0336 21.5717 33.0336C22.8664 33.0336 24.1386 32.6956 25.2626 32.0529C25.9621 31.6572 26.7522 31.4493 27.5559 31.4493C28.3596 31.4493 29.1496 31.6572 29.8492 32.0529C30.9847 32.7018 32.2681 33.0474 33.5759 33.0562C34.8393 33.0536 36.0781 32.7068 37.1592 32.0529C37.4754 31.8701 37.8122 31.7258 38.1626 31.6229C38.6187 31.4899 39.0034 31.181 39.2318 30.7644C39.4603 30.3478 39.5139 29.8574 39.3809 29.4012C39.2478 28.9451 38.939 28.5604 38.5224 28.332C38.1057 28.1035 37.6154 28.0499 37.1592 28.1829H37.1234ZM37.1234 19.2246C36.4952 19.4184 35.8934 19.6892 35.3317 20.0308C34.761 20.3646 34.1117 20.5405 33.4505 20.5405C32.7893 20.5405 32.14 20.3646 31.5692 20.0308C30.327 19.334 28.9265 18.968 27.5021 18.968C26.0778 18.968 24.6773 19.334 23.4351 20.0308C22.8582 20.366 22.203 20.5425 21.5359 20.5425C20.8688 20.5425 20.2135 20.366 19.6367 20.0308C18.3945 19.334 16.994 18.968 15.5696 18.968C14.1453 18.968 12.7448 19.334 11.5026 20.0308C10.9318 20.3646 10.2825 20.5405 9.6213 20.5405C8.96011 20.5405 8.31082 20.3646 7.74005 20.0308C7.17835 19.6892 6.57656 19.4184 5.94839 19.2246C5.71379 19.136 5.46321 19.0977 5.21287 19.112C4.96252 19.1264 4.71798 19.1932 4.49506 19.308C4.27214 19.4229 4.07581 19.5832 3.91877 19.7787C3.76172 19.9742 3.64747 20.2005 3.58339 20.4429C3.51751 20.6688 3.49676 20.9054 3.52233 21.1393C3.54791 21.3732 3.6193 21.5998 3.73243 21.8061C3.84556 22.0124 3.99822 22.1944 4.18169 22.3417C4.36516 22.489 4.57585 22.5987 4.80172 22.6646C5.15209 22.7675 5.48892 22.9118 5.80505 23.0946C6.91556 23.7574 8.18471 24.1073 9.47797 24.1073C10.7712 24.1073 12.0404 23.7574 13.1509 23.0946C13.8505 22.6989 14.6405 22.491 15.4442 22.491C16.2479 22.491 17.038 22.6989 17.7376 23.0946C18.8615 23.7372 20.1337 24.0753 21.4284 24.0753C22.7231 24.0753 23.9953 23.7372 25.1192 23.0946C25.8188 22.6989 26.6088 22.491 27.4126 22.491C28.2163 22.491 29.0063 22.6989 29.7059 23.0946C30.8413 23.7435 32.1248 24.089 33.4326 24.0979C34.696 24.0953 35.9348 23.7484 37.0159 23.0946C37.332 22.9118 37.6688 22.7675 38.0192 22.6646C38.4754 22.5315 38.86 22.2227 39.0885 21.8061C39.317 21.3894 39.3706 20.8991 39.2376 20.4429C39.1045 19.9867 38.7957 19.6021 38.379 19.3736C37.9624 19.1451 37.4721 19.0915 37.0159 19.2246H37.1234Z"
                                            fill="white"
                                          />
                                        </svg>
                                      </div>
                                      <div class="form__limit--text">
                                        Рыбохозяйственные водоемы международного и республиканского
                                        значения
                                      </div>
                                      <button @click="chapter = 'republic'">
                                        {{ $t('button.more') }}
                                      </button>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-lg-6">
                                  <div class="form__checkbox--chapter">
                                    <div class="form__limit--btn">
                                      <div class="form__limit--icon">
                                        <svg
                                          width="43"
                                          height="43"
                                          viewBox="0 0 43 43"
                                          fill="none"
                                          xmlns="http://www.w3.org/2000/svg"
                                        >
                                          <path
                                            d="M4.87339 13.7062C5.22375 13.8091 5.56058 13.9535 5.87672 14.1362C6.98722 14.799 8.25638 15.149 9.54964 15.149C10.8429 15.149 12.1121 14.799 13.2226 14.1362C13.9221 13.7406 14.7122 13.5326 15.5159 13.5326C16.3196 13.5326 17.1096 13.7406 17.8092 14.1362C18.9331 14.7789 20.2054 15.117 21.5001 15.117C22.7947 15.117 24.067 14.7789 25.1909 14.1362C25.8905 13.7406 26.6805 13.5326 27.4842 13.5326C28.2879 13.5326 29.078 13.7406 29.7776 14.1362C30.913 14.7852 32.1965 15.1307 33.5042 15.1396C34.7677 15.137 36.0065 14.7901 37.0876 14.1362C37.4037 13.9535 37.7405 13.8091 38.0909 13.7062C38.5471 13.5732 38.9317 13.2644 39.1602 12.8477C39.3887 12.4311 39.4423 11.9408 39.3092 11.4846C39.1762 11.0284 38.8674 10.6438 38.4507 10.4153C38.0341 10.1868 37.5437 10.1332 37.0876 10.2662C36.4594 10.4601 35.8576 10.7309 35.2959 11.0725C34.7251 11.4063 34.0758 11.5822 33.4146 11.5822C32.7534 11.5822 32.1042 11.4063 31.5334 11.0725C30.2911 10.3757 28.8907 10.0097 27.4663 10.0097C26.0419 10.0097 24.6415 10.3757 23.3992 11.0725C22.8224 11.4076 22.1672 11.5842 21.5001 11.5842C20.8329 11.5842 20.1777 11.4076 19.6009 11.0725C18.3586 10.3757 16.9582 10.0097 15.5338 10.0097C14.1094 10.0097 12.709 10.3757 11.4667 11.0725C10.896 11.4063 10.2467 11.5822 9.58547 11.5822C8.92427 11.5822 8.27498 11.4063 7.70422 11.0725C7.14252 10.7309 6.54073 10.4601 5.91255 10.2662C5.45638 10.1332 4.96604 10.1868 4.54939 10.4153C4.13275 10.6438 3.82394 11.0284 3.69089 11.4846C3.55784 11.9408 3.61145 12.4311 3.83993 12.8477C4.06841 13.2644 4.45305 13.5732 4.90922 13.7062H4.87339ZM37.1234 28.1829C36.4952 28.3768 35.8934 28.6476 35.3317 28.9892C34.761 29.3229 34.1117 29.4989 33.4505 29.4989C32.7893 29.4989 32.14 29.3229 31.5692 28.9892C30.327 28.2923 28.9265 27.9264 27.5021 27.9264C26.0778 27.9264 24.6773 28.2923 23.4351 28.9892C22.8582 29.3243 22.203 29.5008 21.5359 29.5008C20.8688 29.5008 20.2135 29.3243 19.6367 28.9892C18.3945 28.2923 16.994 27.9264 15.5696 27.9264C14.1453 27.9264 12.7448 28.2923 11.5026 28.9892C10.9318 29.3229 10.2825 29.4989 9.6213 29.4989C8.96011 29.4989 8.31082 29.3229 7.74005 28.9892C7.17835 28.6476 6.57656 28.3768 5.94839 28.1829C5.72251 28.117 5.48587 28.0963 5.25198 28.1219C5.01809 28.1474 4.79153 28.2188 4.58523 28.332C4.37893 28.4451 4.19693 28.5977 4.04963 28.7812C3.90232 28.9647 3.7926 29.1754 3.72672 29.4012C3.66084 29.6271 3.64009 29.8638 3.66567 30.0976C3.69124 30.3315 3.76263 30.5581 3.87576 30.7644C3.9889 30.9707 4.14155 31.1527 4.32502 31.3C4.50849 31.4473 4.71918 31.557 4.94505 31.6229C5.29542 31.7258 5.63225 31.8701 5.94839 32.0529C7.05889 32.7157 8.32805 33.0657 9.6213 33.0657C10.9146 33.0657 12.1837 32.7157 13.2942 32.0529C13.9938 31.6572 14.7838 31.4493 15.5876 31.4493C16.3913 31.4493 17.1813 31.6572 17.8809 32.0529C19.0048 32.6956 20.277 33.0336 21.5717 33.0336C22.8664 33.0336 24.1386 32.6956 25.2626 32.0529C25.9621 31.6572 26.7522 31.4493 27.5559 31.4493C28.3596 31.4493 29.1496 31.6572 29.8492 32.0529C30.9847 32.7018 32.2681 33.0474 33.5759 33.0562C34.8393 33.0536 36.0781 32.7068 37.1592 32.0529C37.4754 31.8701 37.8122 31.7258 38.1626 31.6229C38.6187 31.4899 39.0034 31.181 39.2318 30.7644C39.4603 30.3478 39.5139 29.8574 39.3809 29.4012C39.2478 28.9451 38.939 28.5604 38.5224 28.332C38.1057 28.1035 37.6154 28.0499 37.1592 28.1829H37.1234ZM37.1234 19.2246C36.4952 19.4184 35.8934 19.6892 35.3317 20.0308C34.761 20.3646 34.1117 20.5405 33.4505 20.5405C32.7893 20.5405 32.14 20.3646 31.5692 20.0308C30.327 19.334 28.9265 18.968 27.5021 18.968C26.0778 18.968 24.6773 19.334 23.4351 20.0308C22.8582 20.366 22.203 20.5425 21.5359 20.5425C20.8688 20.5425 20.2135 20.366 19.6367 20.0308C18.3945 19.334 16.994 18.968 15.5696 18.968C14.1453 18.968 12.7448 19.334 11.5026 20.0308C10.9318 20.3646 10.2825 20.5405 9.6213 20.5405C8.96011 20.5405 8.31082 20.3646 7.74005 20.0308C7.17835 19.6892 6.57656 19.4184 5.94839 19.2246C5.71379 19.136 5.46321 19.0977 5.21287 19.112C4.96252 19.1264 4.71798 19.1932 4.49506 19.308C4.27214 19.4229 4.07581 19.5832 3.91877 19.7787C3.76172 19.9742 3.64747 20.2005 3.58339 20.4429C3.51751 20.6688 3.49676 20.9054 3.52233 21.1393C3.54791 21.3732 3.6193 21.5998 3.73243 21.8061C3.84556 22.0124 3.99822 22.1944 4.18169 22.3417C4.36516 22.489 4.57585 22.5987 4.80172 22.6646C5.15209 22.7675 5.48892 22.9118 5.80505 23.0946C6.91556 23.7574 8.18471 24.1073 9.47797 24.1073C10.7712 24.1073 12.0404 23.7574 13.1509 23.0946C13.8505 22.6989 14.6405 22.491 15.4442 22.491C16.2479 22.491 17.038 22.6989 17.7376 23.0946C18.8615 23.7372 20.1337 24.0753 21.4284 24.0753C22.7231 24.0753 23.9953 23.7372 25.1192 23.0946C25.8188 22.6989 26.6088 22.491 27.4126 22.491C28.2163 22.491 29.0063 22.6989 29.7059 23.0946C30.8413 23.7435 32.1248 24.089 33.4326 24.0979C34.696 24.0953 35.9348 23.7484 37.0159 23.0946C37.332 22.9118 37.6688 22.7675 38.0192 22.6646C38.4754 22.5315 38.86 22.2227 39.0885 21.8061C39.317 21.3894 39.3706 20.8991 39.2376 20.4429C39.1045 19.9867 38.7957 19.6021 38.379 19.3736C37.9624 19.1451 37.4721 19.0915 37.0159 19.2246H37.1234Z"
                                            fill="white"
                                          />
                                        </svg>
                                      </div>
                                      <div class="form__limit--text">
                                        Рыбохозяйственные водоемы местного значения
                                      </div>
                                      <button @click="chapter = 'local'">
                                        {{ $t('button.more') }}
                                      </button>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="form__line">
                    <div class="form__line--left"></div>
                    <div class="form__line--right">
                      <div class="col-lg-12">
                        <div
                          class="form__block--line form__messages"
                          v-if="message.status"
                          :class="{
                            'form__messages--error': message.status != 200,
                            'form__messages--success': message.status == 200,
                          }"
                        >
                          <label class="form__block--input">
                            <span class="form__block--title">
                              {{ message.text }}
                            </span>
                          </label>
                        </div>
                        <div
                          class="form__block--line form__messages"
                          v-if="errorMessage.text"
                          :class="{
                            'form__messages--error': errorMessage.status != 200,
                            'form__messages--success': errorMessage.status == 200,
                          }"
                        >
                          <label class="form__block--input">
                            <span class="form__block--title">
                              {{ errorMessage.text }}
                            </span>
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import { api } from '@/boot/axios';

export default {
  data() {
    return {
      applications: null,
      chapter: null,

      errorMessage: {
        status: null,
        messages: null,
        text: null,
      },
      message: {
        status: null,
        text: null,
      },
    };
  },

  computed: {},
  methods: {
    onSubmit(evt) {
      this.errorMessage = {
        status: null,
        messages: null,
        text: null,
      };
      this.message = {
        status: null,
        text: null,
      };
      const formData = new FormData(evt.target);
      api
        .post('limit/create', formData, {
          headers: {
            'Content-Type': 'multipart/form-data',
          },
        })
        .then((response) => {
          if (response.status == 200) {
            this.message.status = 200;
            this.message.text = response.data.message;
            this.$router.push({
              path:
                '/' +
                this.$i18n.locale +
                '/account/limits/' +
                response.data.data.id +
                '/' +
                this.chapter,
            });
          }
        })
        .catch((error) => {
          if (error?.response?.status == 500) {
            this.errorMessage.status = 500;
            this.errorMessage.text = this.$t('system_message.500');
          }
          if (error?.response?.status == 401) {
            this.errorMessage.status = 401;
            this.errorMessage.text = error.response.data.error_message;
            this.$router.push('/' + this.$i18n.locale + '/login');
          }
          if (error?.response?.status == 422) {
            this.errorMessage.status = 422;
            this.errorMessage.text = error.response.data.error_message;
          }
          this.errorMessage.messages = error.response.data.error_messages;
        });
    },
  },
  beforeMount() {},
  beforeCreate() {
    if (!localStorage.token) {
      this.$router.push('/ru/login');
    }
  },
};
</script>
